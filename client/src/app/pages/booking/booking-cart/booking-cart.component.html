<section class="mx-auto px-4 py-8 max-w-[1400px]">
  <h1>Dina bokningar</h1>

  <div class="flex flex-row gap-16">
    <div class="listing-details w-1/2">
      <div *ngFor="let booking of bookings">
        <h2>{{ booking.listing_name || "Namn på boende" }}</h2>
        <div class="listing-details-section">
          <div>
            <h3>Datum</h3>
            <div>
              {{ formatDateRange(booking.start_date, booking.end_date) }}
            </div>
          </div>
          <app-link linkType="secondary" (click)="openDateModal(booking)"
            >Redigera</app-link
          >
        </div>
        <div class="listing-details-section">
          <div>
            <h3>Gäster</h3>
            <div>{{ getGuestText(booking) }}</div>
          </div>
          <app-link linkType="secondary" (click)="openGuestModal(booking)"
            >Redigera</app-link
          >
        </div>
      </div>
    </div>
    <aside class="border border-brand-mediumGray rounded-2xl w-1/2 p-6 h-fit">
      <h2 class="mt-0 mb-0">Prissummering</h2>
      <p>
        Pris för {{ bookings.length }}
        {{ bookings.length === 1 ? "boende" : "boenden" }}
      </p>
      <div class="h-[1px] bg-brand-shadowGray mb-8 mt-4"></div>

      <div *ngFor="let booking of bookings">
        <h3>{{ booking.listing_name || "Namn på boende" }}</h3>
        <div class="flex justify-between items-center">
          <p>{{ booking.total_price }} SEK</p>
          <button
            (click)="deleteBooking(booking.listing_id)"
            class="text-brand-redHoverLight hover:text-brand-redHoverDark"
          >
            <i class="bi bi-trash"></i>
          </button>
        </div>
      </div>
      <div class="h-[1px] bg-brand-shadowGray my-8"></div>

      <h3>Totalt</h3>
      <p class="font-semibold">{{ totalPrice }} SEK</p>
    </aside>
  </div>
  <div class="flex flex-row justify-between pt-8 items-center">
    <app-link linkType="secondary" (click)="onCancel()">Avbryt</app-link>
    <app-button buttonType="primary" (click)="onBook()"
      >Vidare till betalning</app-button
    >
  </div>

  <!-- Modal för gästantal -->
  <app-modal-lg
    #guestModal
    heading="Redigera antal gäster"
    (modalClose)="onGuestModalClose()"
  >
    <app-counter-option
      label="Vuxna"
      description="Från 13 år och uppåt"
      [(ngModel)]="adults"
      section1
    ></app-counter-option>
    <app-counter-option
      label="Barn"
      description="Ålder 2-12"
      [(ngModel)]="children"
      section1
    ></app-counter-option>
    <app-counter-option
      label="Spädbarn"
      description="Under 2 år"
      [(ngModel)]="infants"
      section1
    ></app-counter-option>
    <app-counter-option
      label="Husdjur"
      description="Tar du med ett tjänstedjur"
      [(ngModel)]="pets"
      section1
    ></app-counter-option>

    <div class="flex justify-end gap-2 mt-4">
      <app-button buttonType="secondary" (click)="cancelGuests()"
        >Avbryt</app-button
      >
      <app-button buttonType="primary" (click)="saveGuests()">Spara</app-button>
    </div>
  </app-modal-lg>

  <!-- Modal för datum -->
  <app-modal-lg
    #dateModal
    heading="Redigera datum"
    primaryButtonText="Avbryt"
    secondaryButtonText="Spara"
    (modalClose)="onDateModalClose()"
    (primaryButtonClick)="cancelDates()"
    (secondaryButtonClick)="saveDates(); dateModal.close()"
    [divider]="true"
    [shadow]="false"
  >
    <div section1>
      <app-text-input
        label="Incheckning"
        inputType="date"
        [(ngModel)]="checkIn"
        placeholderType="today"
      ></app-text-input>
      <app-text-input
        label="Utcheckning"
        inputType="date"
        [(ngModel)]="checkOut"
        placeholderType="plus7"
      ></app-text-input>
    </div>
  </app-modal-lg>
</section>
